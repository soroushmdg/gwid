library(gwid)
setwd("C:/Users/soroush/OneDrive - Marquette University/Soroush/test")
caco <- gwid::case_control(case_control_rda = "../test/case-cont-RA.withmap.Rda")
pieces <- gwid::build_gwas(gds_data = "../test/chr3.gds",caco = caco,gwas_generator = TRUE)
ag.pieces <- gwid::extract(pieces)
myphase <- gwid::build_phase(phased_vcf = "../test/chr3.vcf",caco = caco)
myregion2 <- gwid::build_gwid(ibd_data = "../test/chr3.ibd",gwas = pieces)
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 118926294,snp_end = 122613594)
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 118926294,snp_end = 122613594)
library(gwid)
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 118926294,snp_end = 122613594)
w
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 118926294,snp_end = 122613594)
Mres_reduced$cases
Mres_reduced$case1
Mres_reduced$case2
Mres_reduced$cont1
Mres_reduced$cont2
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 118926294,snp_end = 122613594)
snp_pos_total
snp_indx
leni
snp_pos_plot
w
obj$profile |> class()
snp_indx
kkk <- lapply(obj[[
which(unlist(lapply(obj, inherits, "profile")))
]], "[", j = snp_indx)
which(unlist(lapply(obj, inherits, "profile")))
obj$ibd |> class()
lapply(obj, inherits, "profile")
names(obj)
obj[[1]]$cases
apply(obj[[1]],1,sum)
apply(obj[[1]]$cases,1,sum)
obj[[1]]$cases |> dim()
obj$profile$cases |> dim()
obj$profile$case1 |> dim()
snp_indx |> range()
snp_indx |> length()
kkk$cases |> dim()
kkk <- lapply(obj[[
which(unlist(lapply(obj, inherits, "profile")))
]], "[", j = snp_indx)
kkk$cases
kkk <- lapply(obj[[
which(unlist(lapply(obj, inherits, "profile")))
]], '[', j = snp_indx)
kkk$cases
kkk <- lapply(obj[[
which(unlist(lapply(obj, inherits, "profile")))
]], '[', j = snp_indx,exact = TRUE)
kkk$cases
kkk$cases |> dim()
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 118926294,snp_end = 122613594)
library(gwid)
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 118926294,snp_end = 122613594)
mygwid_win
mygwid_win |> class()
myfishertest_resultsnps <- gwid::fisher_test(mygwid_win,caco,reference = "cases")
plot(myfishertest_resultsnps)
myfishertest_resultsnps
kkk <- gwid::extract_window(myregion2,w = 30)
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 115926294,snp_end = 125613594)
plot(mygwid_win,title = "gwid subset")
myfishertest_resultsnps <- gwid::fisher_test(mygwid_win,caco,reference = "cases")
plot(myfishertest_resultsnps)
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 118926294,snp_end = 122613594)
kkk <- gwid::extract_window(myregion2,w = 30,snp_start = 115926294,snp_end = 125613594)
plot(kkk)
k2 <- gwid::fisher_test(kkk,caco,reference = "cases")
plot(k2)
