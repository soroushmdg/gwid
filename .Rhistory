runApp('C:/Users/soroush/Marquette University/Maadooliat, Mehdi - Soroush/test/soroush_draftibd')
runApp('C:/Users/soroush/Marquette University/Maadooliat, Mehdi - Soroush/test/soroush_draftibd')
use_r("case_control")
styler::style_pkg()
library(devtools)
use_r("case_contrl")
load_all()
check()
load_all()
use_r("build")
styler:::style_selection()
load_all()
check()
use_r("extract")
load_all()
load_all()
check()
use_r("fisher_test")
load_all()
check()
use_r("haplotype_structure")
load_all()
check()
use_r("roh")
styler:::style_selection()
styler:::style_selection()
use_r("plot")
styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
styler:::style_selection()
load_all()
load_all()
check()
caco <- gwid::case_control(case_control_rda = "../test/case-cont-RA.withmap.Rda")
pieces <- gwid::build_gwas(gds_data = "../test/chr22.gds",caco = caco,gwas_generator = TRUE)
myphase <- gwid::build_phase(phased_vcf = "../test/chr22.vcf",caco = caco)
myregion2 <- gwid::build_gwid(ibd_data = "../test/chr22.ibd",gwas = pieces)
caco <- gwid::case_control(case_control_rda = "../test/case-cont-RA.withmap.Rda")
pieces <- gwid::build_gwas(gds_data = "../test/chr3.gds",caco = caco,gwas_generator = TRUE)
myphase <- gwid::build_phase(phased_vcf = "../test/chr3.vcf",caco = caco)
myregion2 <- gwid::build_gwid(ibd_data = "../test/chr3.ibd",gwas = pieces)
fishgwid <- gwid::fisher_test(myregion2,caco = caco,snp_start = 118926294,snp_end = 122613594,reference = "cases")
fishgwid
fishgwid$value |> min()
fishgwid$value |> sort(decreasing=F)[1:3]
fishgwid$value |> sort(decreasing=F)
fishgwid$value |> sort(decreasing=F)[1:10]
sort(fishgwid$value,decreasing=F)[1:10]
sort(fishgwid$value,decreasing=F)[1:10] |> which()
fishgwid
fishgwid[min(value),snp_pos]
fishgwid[which(fishgwid$value == min(fishgwid$value)),]
order(fishgwid$value,decreasing = F)[1:10]
fishgwid[order(fishgwid$value,decreasing = F)[1:10],]
fishgwid[order(fishgwid$value,decreasing = F)[1:100],]
fishgwid[order(fishgwid$value,decreasing = F)[1:10],]
pieces$snp.id
pieces$smp.snp
fishgwid[order(fishgwid$value,decreasing = F)[1:10],]
a <- gwid::subset(myregion2,snp_start = 118926294,snp_end = 119409294)
caco <- gwid::case_control(case_control_rda = "../test/case-cont-RA.withmap.Rda")
pieces <- gwid::build_gwas(gds_data = "../test/chr3.gds",caco = caco,gwas_generator = TRUE)
myphase <- gwid::build_phase(phased_vcf = "../test/chr3.vcf",caco = caco)
myregion2 <- gwid::build_gwid(ibd_data = "../test/chr3.ibd",gwas = pieces)
a <- gwid::subset(myregion2,snp_start = 118926294,snp_end = 119409294)
b <- plot(a,plot_type = "profile",reference = "cases")
b
a$Mres_reduced$cases |> dim()
a <- gwid::subset(myregion2,snp_start = 118926294,snp_end = 119009294)
a$Mres_reduced$cases |> dim()
b <- plot(a,plot_type = "profile",reference = "cases")
b
a <- gwid::subset(myregion2,snp_start = 110926294,snp_end = 111009294)
a$Mres_reduced$cases |> dim()
b <- plot(a,plot_type = "profile",reference = "cases")
b
a <- gwid::subset(myregion2,snp_start = 119926294,snp_end = 120009294)
b <- plot(a,plot_type = "profile",reference = "cases")
b
a$Mres_reduced$cases |> dim()
a <- gwid::subset(myregion2,snp_start = 119926294,snp_end = 129009294)
b <- plot(a,plot_type = "profile",reference = "cases")
b
a <- gwid::subset(myregion2,snp_start = 119926294,snp_end = 120909294)
b <- plot(a,plot_type = "profile",reference = "cases")
b
a <- gwid::subset(myregion2,snp_start = 119926294,snp_end = 120409294)
b <- plot(a,plot_type = "profile",reference = "cases")
b
a <- gwid::subset(myregion2,snp_start = 119926294,snp_end = 120109294)
b <- plot(a,plot_type = "profile",reference = "cases")
b
a <- gwid::subset(myregion2,snp_start = 119926294,snp_end = 120309294)
b <- plot(a,plot_type = "profile",reference = "cases")
b
a$Mres_reduced$cases |> dim()
a$snp_pos
temp <- a
temp$Mres_reduced <- temp$Mres_reduced$cases[1:10,1:10]
temp <- a
temp$Mres_reduced <- temp$Mres_reduced$cases[1:10,1:10]
temp$snp_pos <- temp$snp[1:10]
class(temp)
plot(temp,plot_type = "profile",reference = "cases")
temp <- a
temp$Mres_reduced$cases <- temp$Mres_reduced$cases[1:10,1:10]
temp$snp_pos <- temp$snp[1:10]
plot(temp)
plot(temp,plot_type = "profile",reference = "cases")
set.seed(2); N <- 15; p <- 20; LWD <- 40
x <- rpois(N,5); x <- cbind(x,rpois(N,15))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l",xlim=c(1,20),ylim=c(1,N), lwd=LWD, col=8)
for(i in 2:N) points(x[i,],y[i,],type="l",xlim=c(1,p), lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=3)
for(i in 2:N) points(x[i,],y[i,],type="l",xlim=c(1,p), lwd=LWD, lty=2, col=sample(c(2,3,8),prob =c(0.3,0.15,.55)))
X <- 7
abline(v=X)
points(cbind(X,which(x[,1]<=X & x[,2]>=X)))
set.seed(2); N <- 15; p <- 20; LWD <- 40
x <- rpois(N,5); x <- cbind(x,rpois(N,15))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l",xlim=c(1,20),ylim=c(1,N), lwd=LWD, col=8,ylab="",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l",xlim=c(1,p), lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=3)
for(i in 2:N) points(x[i,],y[i,],type="l",xlim=c(1,p), lwd=LWD, lty=2, col=sample(c(2,3,8),prob =c(0.3,0.15,.55)))
X <- 7
abline(v=X)
points(cbind(X,which(x[,1]<=X & x[,2]>=X)))
set.seed(2); N <- 15; p <- 20; LWD <- 40
x <- rpois(N,5); x <- cbind(x,rpois(N,15))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l",xlim=c(1,20),ylim=c(1,N), lwd=LWD, col=8,ylab="",yaxt = "n",xlab = "")
for(i in 2:N) points(x[i,],y[i,],type="l",xlim=c(1,p), lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=3)
for(i in 2:N) points(x[i,],y[i,],type="l",xlim=c(1,p), lwd=LWD, lty=2, col=sample(c(2,3,8),prob =c(0.3,0.15,.55)))
X <- 7
abline(v=X)
points(cbind(X,which(x[,1]<=X & x[,2]>=X)))
set.seed(2); N <- 15; p <- 20; LWD <- 40
x <- rpois(N,5); x <- cbind(x,rpois(N,15))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l",xlim=c(1,20),ylim=c(1,N), lwd=LWD, col=8,ylab="",yaxt = "n",xlab = "",xaxt="n")
for(i in 2:N) points(x[i,],y[i,],type="l",xlim=c(1,p), lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=3)
for(i in 2:N) points(x[i,],y[i,],type="l",xlim=c(1,p), lwd=LWD, lty=2, col=sample(c(2,3,8),prob =c(0.3,0.15,.55)))
X <- 7
abline(v=X)
points(cbind(X,which(x[,1]<=X & x[,2]>=X)))
set.seed(2); N <- 50; p <- 20; LWD <- 11
pois.mu <- c(500,600); cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1]); x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8)
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3]); abline(v=X2,col=cols[3]);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=cols[3])
## Dr. Maadooliat
library(scales)
scales::alpha()
set.seed(2); N <- 50; p <- 20; LWD <- 11
pois.mu <- c(500,600); cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1]); x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8)
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3]); abline(v=X2,col=cols[3]);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.4))
library(scales)
set.seed(2); N <- 50; p <- 20; LWD <- 11
pois.mu <- c(500,600); cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1]); x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3]); abline(v=X2,col=cols[3]);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.4))
set.seed(2); N <- 50; p <- 20; LWD <- 11
pois.mu <- c(500,600); cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1]); x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3]); abline(v=X2,col=cols[3]);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.2))
library(scales)
set.seed(2); N <- 50; p <- 20; LWD <- 11
pois.mu <- c(500,600); cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1]); x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3]); abline(v=X2,col=cols[3]);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.3))
set.seed(2); N <- 50; p <- 20; LWD <- 11
pois.mu <- c(500,600); cols <- c(3,2,4,rainbow(5))
rpois(N,pois.mu[1])
N <- 50
p <- 20
LWD <- 11
set.seed(2)
N <- 50
p <- 20
LWD <- 11
pois.mu <- c(500,600)
cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1])
x <- cbind(x,rpois(N,pois.mu[2]))
x
rpois(n = 1,1)
rpois(n = 1,2)
rpois(n = 1,20)
rpois(n = 1,200)
rpois(n = 1,5)
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
set.seed(2)
N <- 50
p <- 20
LWD <- 11
pois.mu <- c(500,600)
cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1])
x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
x[1,]
y[1,]
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
pois.mu[1]
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3]); abline(v=X2,col=cols[3]);
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.3))
?abline
set.seed(2)
N <- 50
p <- 20
LWD <- 11
pois.mu <- c(500,600)
cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1])
x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3],type = "n"); abline(v=X2,col=cols[3]);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.3))
abline(v=X1,col=cols[3],type = "b"); abline(v=X2,col=cols[3]);
set.seed(2)
N <- 50
p <- 20
LWD <- 11
pois.mu <- c(500,600)
cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1])
x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3],type = "b"); abline(v=X2,col=cols[3]);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.3))
?par
abline(v=X1,col=cols[3],lty = 0); abline(v=X2,col=cols[3]);
library(scales)
set.seed(2)
N <- 50
p <- 20
LWD <- 11
pois.mu <- c(500,600)
cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1])
x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3],lty = 0); abline(v=X2,col=cols[3]);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.3))
library(scales)
set.seed(2)
N <- 50
p <- 20
LWD <- 11
pois.mu <- c(500,600)
cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1])
x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3],lty = 0); abline(v=X2,col=cols[3],lty=0);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.3))
library(scales)
set.seed(2)
N <- 50
p <- 20
LWD <- 11
pois.mu <- c(500,600)
cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1])
x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3],lty = 1); abline(v=X2,col=cols[3],lty=1);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.3))
library(scales)
set.seed(2)
N <- 50
p <- 20
LWD <- 11
pois.mu <- c(500,600)
cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1])
x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3],lty = 2); abline(v=X2,col=cols[3],lty=2);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.3))
abline(v=X1,col=cols[3],lty = 3); abline(v=X2,col=cols[3],lty=3);
library(scales)
set.seed(2)
N <- 50
p <- 20
LWD <- 11
pois.mu <- c(500,600)
cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1])
x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3],lty = 4); abline(v=X2,col=cols[3],lty=4);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.3))
library(scales)
set.seed(2)
N <- 50
p <- 20
LWD <- 11
pois.mu <- c(500,600)
cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1])
x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3],lty = 3); abline(v=X2,col=cols[3],lty=3);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.3))
library(scales)
set.seed(2)
N <- 50
p <- 20
LWD <- 11
pois.mu <- c(500,600)
cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1])
x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3],lty = 2); abline(v=X2,col=cols[3],lty=2);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.3))
library(scales)
set.seed(2)
N <- 50
p <- 20
LWD <- 11
pois.mu <- c(500,600)
cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1])
x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3],lty = 4); abline(v=X2,col=cols[3],lty=4);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.3))
library(scales)
set.seed(2)
N <- 50
p <- 20
LWD <- 11
pois.mu <- c(500,600)
cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1])
x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3],lty = 5); abline(v=X2,col=cols[3],lty=5);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.3))
library(scales)
set.seed(2)
N <- 50
p <- 20
LWD <- 11
pois.mu <- c(500,600)
cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1])
x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3],lty = 6); abline(v=X2,col=cols[3],lty=6);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.3))
library(scales)
set.seed(2)
N <- 50
p <- 20
LWD <- 11
pois.mu <- c(500,600)
cols <- c(3,2,4,rainbow(5))
x <- rpois(N,pois.mu[1])
x <- cbind(x,rpois(N,pois.mu[2]))
y <- cbind(1:N,1:N)
plot(x[1,],y[1,],type="l", xlim=range(x), ylim=c(1,N), lwd=LWD, col=8,xlab = "",xaxt = "n",ylab = "",yaxt = "n")
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, col=8)
points(x[12,],c(12,12),type="l", lwd=LWD, col=cols[1])
for(i in 2:N) points(x[i,],y[i,],type="l", lwd=LWD, lty=2, col=sample(c(cols[2],3,8),prob =c(0.2,0.1,.55)))
X1 <- pois.mu[1]-15; X2 <- pois.mu[2]-100;
abline(v=X1,col=cols[3],lty = 3); abline(v=X2,col=cols[3],lty=3);
#points(cbind(X1,which(x[,1]<=X1 & x[,2]>=X2)))
#for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1,X2),y[i,], type="b", lwd=LWD/2, lty =3, col=cols[3])
for (i in which(x[,1]<=X1 & x[,2]>=X2)) points(c(X1+1,X2-1),y[i,], type="l", lwd=LWD, lty=1, col=alpha(cols[3],.3))
