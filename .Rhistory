library(gwid)
setwd("C:/Users/soroush/OneDrive - Marquette University/Soroush/test")
caco <- gwid::case_control(case_control_rda = "../test/case-cont-RA.withmap.Rda")
pieces <- gwid::build_gwas(gds_data = "../test/chr3.gds",caco = caco,gwas_generator = TRUE)
ag.pieces <- gwid::extract(pieces)
myphase <- gwid::build_phase(phased_vcf = "../test/chr3.vcf",caco = caco)
myregion2 <- gwid::build_gwid(ibd_data = "../test/chr3.ibd",gwas = pieces)
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 118926294,snp_end = 122613594)
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 118926294,snp_end = 122613594)
library(gwid)
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 118926294,snp_end = 122613594)
w
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 118926294,snp_end = 122613594)
Mres_reduced$cases
Mres_reduced$case1
Mres_reduced$case2
Mres_reduced$cont1
Mres_reduced$cont2
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 118926294,snp_end = 122613594)
snp_pos_total
snp_indx
leni
snp_pos_plot
w
obj$profile |> class()
snp_indx
kkk <- lapply(obj[[
which(unlist(lapply(obj, inherits, "profile")))
]], "[", j = snp_indx)
which(unlist(lapply(obj, inherits, "profile")))
obj$ibd |> class()
lapply(obj, inherits, "profile")
names(obj)
obj[[1]]$cases
apply(obj[[1]],1,sum)
apply(obj[[1]]$cases,1,sum)
obj[[1]]$cases |> dim()
obj$profile$cases |> dim()
obj$profile$case1 |> dim()
snp_indx |> range()
snp_indx |> length()
kkk$cases |> dim()
kkk <- lapply(obj[[
which(unlist(lapply(obj, inherits, "profile")))
]], "[", j = snp_indx)
kkk$cases
kkk <- lapply(obj[[
which(unlist(lapply(obj, inherits, "profile")))
]], '[', j = snp_indx)
kkk$cases
kkk <- lapply(obj[[
which(unlist(lapply(obj, inherits, "profile")))
]], '[', j = snp_indx,exact = TRUE)
kkk$cases
kkk$cases |> dim()
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 118926294,snp_end = 122613594)
library(gwid)
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 118926294,snp_end = 122613594)
mygwid_win
mygwid_win |> class()
myfishertest_resultsnps <- gwid::fisher_test(mygwid_win,caco,reference = "cases")
plot(myfishertest_resultsnps)
myfishertest_resultsnps
kkk <- gwid::extract_window(myregion2,w = 30)
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 115926294,snp_end = 125613594)
plot(mygwid_win,title = "gwid subset")
myfishertest_resultsnps <- gwid::fisher_test(mygwid_win,caco,reference = "cases")
plot(myfishertest_resultsnps)
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 118926294,snp_end = 122613594)
kkk <- gwid::extract_window(myregion2,w = 30,snp_start = 115926294,snp_end = 125613594)
plot(kkk)
k2 <- gwid::fisher_test(kkk,caco,reference = "cases")
plot(k2)
library(gwid)
caco <- gwid::case_control(case_control_rda = "../test/case-cont-RA.withmap.Rda")
pieces <- gwid::build_gwas(gds_data = "../test/chr3.gds",caco = caco,gwas_generator = TRUE)
ag.pieces <- gwid::extract(pieces)
myphase <- gwid::build_phase(phased_vcf = "../test/chr3.vcf",caco = caco)
myregion2 <- gwid::build_gwid(ibd_data = "../test/chr3.ibd",gwas = pieces)
class(myregion2)
plot(myregion2)
plot(myregion2,ly=F)
kkk <- myregion2
kkk$res
kkk$res[case_control %in% c("cases","cont1")]
kkk$res <- kkk$res[case_control %in% c("cases","cont1")]
plot(kkk,ly=F)
a1 <- ggplot_build(plot(kkk,ly=F))
library(ggplot2)
a1 <- ggplot_build(plot(kkk,ly=F))
a1$data[[1]]$size <- 2
ggplot_gtable(a1)
print(ggplot_gtable(a1))
a2 <- (ggplot_gtable(a1))
print(a2)
library(gwid)
plot(kkk)
plot(kkk,ly=F,line_size = 2)
plot(kkk,ly=F,line_size = 1.5)
plot(kkk,ly=F,line_size = 1)
kkk <- myregion2
kkk$res <- kkk$res[case_control %in% c("cases","cont2")]
plot(kkk,ly=F,line_size = 1)
kkk <- myregion2
kkk$res <- kkk$res[case_control %in% c("cases","cont3")]
plot(kkk,ly=F,line_size = 1)
kkk <- myregion2
kkk$res <- kkk$res[case_control %in% c("cases","cont1")]
#plot(kkk,ly=F,line_size = 1)
plot(kkk,title = "gwid",plot_type = "result_snps",snp_start = 118926294,snp_end = 122613594,line_size = 1)
plot(kkk,title = "gwid",plot_type = "result_snps",snp_start = 115926294,snp_end = 125613594,line_size = 1)
plot(kkk,title = "gwid",plot_type = "result_snps",snp_start = 117926294,snp_end = 123613594,line_size = 1)
plot(kkk,title = "gwid",plot_type = "result_snps",snp_start = 116926294,snp_end = 123613594,line_size = 1)
plot(kkk,title = "gwid",plot_type = "result_snps",snp_start = 116926294,snp_end = 122613594,line_size = 1)
plot(kkk,title = "gwid",plot_type = "result_snps",snp_start = 116926294,snp_end = 122913594,line_size = 1)
plot(kkk,title = "gwid",plot_type = "result_snps",snp_start = 116926294,snp_end = 122913594,line_size = 1,ly=F)
kkk <- myregion2
kkk$res <- kkk$res[case_control %in% c("cases","cont2")]
#plot(kkk,ly=F,line_size = 1)
plot(kkk,title = "gwid",plot_type = "result_snps",snp_start = 116926294,snp_end = 122913594,line_size = 1,ly=F)
kkk <- myregion2
kkk$res <- kkk$res[case_control %in% c("cases","cont3")]
#plot(kkk,ly=F,line_size = 1)
plot(kkk,title = "gwid",plot_type = "result_snps",snp_start = 116926294,snp_end = 122913594,line_size = 1,ly=F)
mygwid_win <- gwid::extract_window(myregion2,w = 10,snp_start = 116926294,snp_end = 122913594)
plot(mygwid_win,title = "gwid subset")
mygwid_win
plot(kkk,title = "gwid subset",line_size = 1,ly=F)
kkk <- mygwid_win[case_control %in% c("cases","cont1")]
plot(kkk,title = "gwid subset",line_size = 1,ly=F)
myfishertest_resultsnps <- gwid::fisher_test(mygwid_win,caco,reference = "cases")
plot(myfishertest_resultsnps)
kkk <- myfishertest_resultsnps
myfishertest_resultsnps
kkk <- mygwid_win[case_control %in% c("cases","cont1")]
plot(kkk,title = "gwid subset",line_size = 1,ly=F)
kkk <- mygwid_win[case_control %in% c("cases","cont2")]
plot(kkk,title = "gwid subset",line_size = 1,ly=F)
kkk <- mygwid_win[case_control %in% c("cases","cont3")]
plot(kkk,title = "gwid subset",line_size = 1,ly=F)
kkk <- myfishertest_resultsnps[case_control %in% c("cases","cont1")]
plot(kkk,line_size = 1,ly=F)
plot(kkk,line_size = 2,ly=F)
plot(kkk,line_size = 3,ly=F)
plot(kkk,line_size = 13,ly=F)
plot(kkk,line_size = 13,ly=F)
library(gwid)
plot(kkk,line_size = 13,ly=F)
library(gwid)
class(kkk)
plot(kkk)
plot(kkk,line_Size = 10)
plot(kkk,line_size = 13,ly=F)
plot(kkk,line_Size = 1,ly=F)
kkk <- myfishertest_resultsnps[case_control %in% c("cases","cont2")]
plot(kkk,line_Size = 1,ly=F)
kkk <- myfishertest_resultsnps[case_control %in% c("cases","cont3")]
plot(kkk,line_Size = 1,ly=F)
hap_str <- gwid::haplotype_structure(myregion2,phase = myphase,w = 10,snp_start = 118926294,snp_end = 122613594)
hap_str <- gwid::haplotype_structure(myregion2,phase = myphase,w = 10,snp_start = 118926294,snp_end = 122613594)
hap_str <- gwid::haplotype_structure(myregion2,phase = myphase,w = 10,snp_start = 118926294,snp_end = 122613594)
library(gwid)
Mres_reduced$cases
library(gwid)
hap_str <- gwid::haplotype_structure(myregion2,phase = myphase,w = 10,snp_start = 118926294,snp_end = 122613594)
hap_str
myhapfreq <- gwid::haplotype_frequency(hap_str)
plot(myhapfreq,plot_type = "result_snps",title = "hap most freq")
plot(myhapfreq,plot_type = "result_snps",title = "hap most freq",ly=T)
plot(myhapfreq,plot_type = "haplotype_structure_frequency",nwin = 1,type = "version1")
plot(myhapfreq,plot_type = "haplotype_structure_frequency",nwin = 1,type = "version1",ly=T)
kkk <- myhapfreq
kkk
kkk$hap_freq <- kkk$hap_freq[case_control %in% c("cases","cont3")]
plot(kkk,plot_type = "haplotype_structure_frequency",nwin = 1,type = "version1",ly=T)
kkk <- myhapfreq
kkk$hap_freq <- kkk$hap_freq[case_control %in% c("cases","cont1")]
plot(kkk,plot_type = "haplotype_structure_frequency",nwin = 1,type = "version1",ly=T)
kkk$hap_freq
kkk$hap_freq$n |> range()
plot(kkk,plot_type = "haplotype_structure_frequency",nwin = 200,type = "version1",ly=T)
plot(kkk,plot_type = "haplotype_structure_frequency",nwin = 200,type = "version1",ly=F)
class(kkk)
library(gwid)
plot(kkk,plot_type = "haplotype_structure_frequency",nwin = 200,type = "version1",ly=F,line_size = 1)
plot(kkk,plot_type = "haplotype_structure_frequency",nwin = 200,type = "version1",ly=F,line_size = 1)
library(gwid)
myhapfreq <- gwid::haplotype_frequency(hap_str)
kkk <- myhapfreq
plot(kkk,plot_type = "haplotype_structure_frequency",nwin = 200,type = "version1",ly=F)
plot(kkk,plot_type = "haplotype_structure_frequency",nwin = 200,type = "version1",ly=F,line_size = 1)
plot(kkk,plot_type = "haplotype_structure_frequency",nwin = 200,type = "version1",ly=F,line_size = 10)
kkk$hap_freq <- kkk$hap_freq[case_control %in% c("cases","cont1")]
plot(kkk,plot_type = "haplotype_structure_frequency",nwin = 200,type = "version1",ly=F,line_size = 10)
class(kkk)
kkk$hap_freq |> class()
kkk$hap_most_freq |> class()
plot(kkk,plot_type = "haplotype_structure_frequency",nwin = 200,type = "version1",ly=F,line_size = 10)
library(gwid)
plot(kkk,plot_type = "haplotype_structure_frequency",nwin = 200,type = "version1",ly=F,line_size = 1)
kkk <- myhapfreq
kkk$hap_freq <- kkk$hap_freq[case_control %in% c("cases","cont2")]
plot(kkk,plot_type = "haplotype_structure_frequency",nwin = 200,type = "version1",ly=F,line_size = 1)
kkk <- myhapfreq
kkk$hap_freq <- kkk$hap_freq[case_control %in% c("cases","cont3")]
plot(kkk,plot_type = "haplotype_structure_frequency",nwin = 200,type = "version1",ly=F,line_size = 1)
plot(kkk,plot_type = "haplotype_structure_frequency",nwin = 200,type = "version2",ly=F,line_size = 1)
library(gwid)
devtools::check(remote = TRUE, manual = TRUE)
devtools::submit_cran()
library(gwid)
devtools::check(remote = TRUE, manual = TRUE)
devtools::submit_cran()
library(gwid)
shiny::runApp('C:/Users/soroush/OneDrive - Marquette University/Soroush/test/soroush_draftibd')
